@model EventDeneme.Models.organizers
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewBag.Title = "Organizer Details";
    
    var rejectFormAttrs = new System.Web.Routing.RouteValueDictionary();
    rejectFormAttrs["class"] = "confirm-form";
    rejectFormAttrs["style"] = "display: inline;";
    rejectFormAttrs["data-message"] = "Are you sure you want to reject this organizer?";
    
}

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
    <h2 style="margin: 0; font-size: 24px; font-weight: 700; color: #111;">Organizer Details</h2>
    <a href="@Url.Action("Organizers", "Admin")" style="background: #6b7280; color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500; font-size: 14px;">Back to List</a>
</div>

<div style="display: grid; gap: 24px;">
    <div style="background: white; padding: 24px; border-radius: 12px; border: 1px solid #e5e7eb;">
        <h3 style="margin: 0 0 20px 0; font-size: 18px; font-weight: 600; color: #111;">Basic Information</h3>
        <div style="display: grid; gap: 16px;">
            <div style="display: grid; grid-template-columns: 150px 1fr; gap: 12px; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                <span style="font-weight: 600; color: #6b7280; font-size: 14px;">ID:</span>
                <span style="color: #111; font-size: 14px;">@Model.id</span>
            </div>
            <div style="display: grid; grid-template-columns: 150px 1fr; gap: 12px; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                <span style="font-weight: 600; color: #6b7280; font-size: 14px;">Legal Name:</span>
                <span style="color: #111; font-size: 14px;">@Model.legal_name</span>
            </div>
            <div style="display: grid; grid-template-columns: 150px 1fr; gap: 12px; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                <span style="font-weight: 600; color: #6b7280; font-size: 14px;">Brand Name:</span>
                <span style="color: #111; font-size: 14px;">@Model.brand_name</span>
            </div>
            <div style="display: grid; grid-template-columns: 150px 1fr; gap: 12px; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                <span style="font-weight: 600; color: #6b7280; font-size: 14px;">Tax ID:</span>
                <span style="color: #111; font-size: 14px;">@(Model.tax_id ?? "N/A")</span>
            </div>
            <div style="display: grid; grid-template-columns: 150px 1fr; gap: 12px; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                <span style="font-weight: 600; color: #6b7280; font-size: 14px;">Contact Email:</span>
                <span style="color: #111; font-size: 14px;">@Model.contact_email</span>
            </div>
            <div style="display: grid; grid-template-columns: 150px 1fr; gap: 12px; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                <span style="font-weight: 600; color: #6b7280; font-size: 14px;">Contact Phone:</span>
                <span style="color: #111; font-size: 14px;">@(Model.contact_phone ?? "N/A")</span>
            </div>
            <div style="display: grid; grid-template-columns: 150px 1fr; gap: 12px; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                <span style="font-weight: 600; color: #6b7280; font-size: 14px;">Status:</span>
                <span style="display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500;
                    @(Model.status == "approved" ? "background: #d1fae5; color: #065f46;" : 
                      Model.status == "rejected" ? "background: #fee2e2; color: #991b1b;" : 
                      "background: #fef3c7; color: #92400e;")">
                    @Model.status
                </span>
            </div>
            <div style="display: grid; grid-template-columns: 150px 1fr; gap: 12px;">
                <span style="font-weight: 600; color: #6b7280; font-size: 14px;">Created At:</span>
                <span style="color: #111; font-size: 14px;">@(Model.created_at?.ToString("dd MMM yyyy HH:mm") ?? "N/A")</span>
            </div>
        </div>
    </div>

    @if (Model.organizer_users != null && Model.organizer_users.Any())
    {
        <div style="background: white; padding: 24px; border-radius: 12px; border: 1px solid #e5e7eb;">
            <h3 style="margin: 0 0 20px 0; font-size: 18px; font-weight: 600; color: #111;">Organizer Users</h3>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f9fafb; border-bottom: 2px solid #e5e7eb;">
                            <th style="padding: 12px; text-align: left; font-weight: 600; color: #111; font-size: 14px;">Username</th>
                            <th style="padding: 12px; text-align: left; font-weight: 600; color: #111; font-size: 14px;">Email</th>
                            <th style="padding: 12px; text-align: left; font-weight: 600; color: #111; font-size: 14px;">Role</th>
                            <th style="padding: 12px; text-align: left; font-weight: 600; color: #111; font-size: 14px;">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var user in Model.organizer_users)
                        {
                            <tr style="border-bottom: 1px solid #e5e7eb;">
                                <td style="padding: 12px; color: #111; font-size: 14px;">@user.username</td>
                                <td style="padding: 12px; color: #6b7280; font-size: 14px;">@user.email</td>
                                <td style="padding: 12px; color: #6b7280; font-size: 14px;">@user.role</td>
                                <td style="padding: 12px;">
                                    <span style="display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500; @(user.status == "active" ? "background: #d1fae5; color: #065f46;" : "background: #f3f4f6; color: #6b7280;")">
                                        @user.status
                                    </span>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }

    @if (Model.organizer_applications != null && Model.organizer_applications.Any())
    {
        <div style="background: white; padding: 24px; border-radius: 12px; border: 1px solid #e5e7eb;">
            <h3 style="margin: 0 0 20px 0; font-size: 18px; font-weight: 600; color: #111;">Applications</h3>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f9fafb; border-bottom: 2px solid #e5e7eb;">
                            <th style="padding: 12px; text-align: left; font-weight: 600; color: #111; font-size: 14px;">Application ID</th>
                            <th style="padding: 12px; text-align: left; font-weight: 600; color: #111; font-size: 14px;">Submitted At</th>
                            <th style="padding: 12px; text-align: left; font-weight: 600; color: #111; font-size: 14px;">Status</th>
                            <th style="padding: 12px; text-align: left; font-weight: 600; color: #111; font-size: 14px;">Review Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var app in Model.organizer_applications)
                        {
                            <tr style="border-bottom: 1px solid #e5e7eb;">
                                <td style="padding: 12px; color: #111; font-size: 14px;">@app.id</td>
                                <td style="padding: 12px; color: #6b7280; font-size: 14px;">@(app.submitted_at?.ToString("dd MMM yyyy HH:mm") ?? "N/A")</td>
                                <td style="padding: 12px;">
                                    <span style="display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500;
                                        @(app.status == "approved" ? "background: #d1fae5; color: #065f46;" : 
                                          app.status == "rejected" ? "background: #fee2e2; color: #991b1b;" : 
                                          "background: #fef3c7; color: #92400e;")">
                                        @app.status
                                    </span>
                                </td>
                                <td style="padding: 12px; color: #6b7280; font-size: 14px;">@(app.review_notes ?? "N/A")</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }

    @if (Model.status == "pending")
    {
        <div style="background: white; padding: 24px; border-radius: 12px; border: 1px solid #e5e7eb;">
            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                using (Html.BeginForm("ApproveOrganizer", "Admin", new { id = Model.id }, FormMethod.Post, new { style = "display: inline;" }))
                {
                    @Html.AntiForgeryToken()
                    <button type="submit" style="background: #10b981; color: white; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; font-size: 14px;">Approve Organizer</button>
                }
                using (Html.BeginForm("RejectOrganizer", "Admin", new { id = Model.id }, FormMethod.Post, rejectFormAttrs))
                {
                    @Html.AntiForgeryToken()
                    <button type="submit" style="background: #ef4444; color: white; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; font-size: 14px;">Reject Organizer</button>
                }
            </div>
        </div>
    }
    </div>
</div>

<style>
    @@media (max-width: 768px) {
        div[style*="grid-template-columns: 150px 1fr"] {
            grid-template-columns: 1fr !important;
        }
        div[style*="grid-template-columns: 150px 1fr"] > span:first-child {
            margin-bottom: 4px;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var forms = document.querySelectorAll('.confirm-form');
        forms.forEach(function (form) {
            form.addEventListener('submit', function (e) {
                e.preventDefault();
                var message = form.getAttribute('data-message');
                var currentForm = this;
                window.showConfirm(
                    message,
                    function () {
                        currentForm.submit();
                    },
                    function () { }
                );
            });
        });
    });
</script>
