@model List<EventDeneme.Models.events>
@{
    ViewBag.Title = "Organizer Dashboard";
    Layout = "~/Views/Shared/_OrganizerLayout.cshtml";
}

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
    <h2 style="margin: 0;">Organizer Dashboard</h2>
    <div style="display: flex; gap: 10px;">
        <a href="@Url.Action("CreateEvent", "Organizer")" style="background: #ea2a33; color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500;">Create Event Request</a>
        <a href="@Url.Action("Applications", "Organizer")" style="background: #6b7280; color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 500;">My Applications</a>
    </div>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 32px;">
    <div style="background: white; padding: 24px; border-radius: 12px; border: 1px solid #e5e7eb; text-align: center;">
        <h3 style="font-size: 32px; color: #ea2a33; margin: 0 0 8px 0;">@Model.Count</h3>
        <p style="color: #666; margin: 0; font-weight: 500;">Active Events</p>
    </div>
    <div style="background: white; padding: 24px; border-radius: 12px; border: 1px solid #e5e7eb; text-align: center;">
        <h3 style="font-size: 32px; color: #ea2a33; margin: 0 0 8px 0;">@(ViewBag.TotalTicketsSold ?? 0)</h3>
        <p style="color: #666; margin: 0; font-weight: 500;">Total Tickets Sold</p>
    </div>
    <div style="background: white; padding: 24px; border-radius: 12px; border: 1px solid #e5e7eb; text-align: center;">
        <h3 style="font-size: 32px; color: #ea2a33; margin: 0 0 8px 0;">@(((decimal)(ViewBag.TotalRevenue ?? 0)).ToString("N2")) â‚º</h3>
        <p style="color: #666; margin: 0; font-weight: 500;">Total Revenue</p>
    </div>
</div>

<h3 style="margin-bottom: 20px;">My Events</h3>
@if (Model.Any())
{
    <div style="background: white; border-radius: 12px; border: 1px solid #e5e7eb; overflow: hidden;">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f9fafb; border-bottom: 2px solid #e5e7eb;">
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #111;">Title</th>
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #111;">Category</th>
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #111;">Status</th>
                    <th style="padding: 16px; text-align: left; font-weight: 600; color: #111;">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var evt in Model)
                {
                    var category = ViewBag.Categories as IEnumerable<EventDeneme.Models.categories>;
                    var catName = category?.FirstOrDefault(c => c.id == evt.category_id)?.display_name ?? evt.category_id.ToString();
                    <tr style="border-bottom: 1px solid #e5e7eb;">
                        <td style="padding: 16px; color: #111;">@evt.title</td>
                        <td style="padding: 16px; color: #666;">@catName</td>
                        <td style="padding: 16px;">
                            <span style="display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500;
                                @(evt.status == "active" ? "background: #d1fae5; color: #065f46;" : 
                                  evt.status == "pending" ? "background: #fef3c7; color: #92400e;" : 
                                  evt.status == "rejected" ? "background: #fee2e2; color: #991b1b;" : 
                                  "background: #f3f4f6; color: #6b7280;")">
                                @evt.status
                            </span>
                        </td>
                        <td style="padding: 16px;">
                            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                <a href="@Url.Action("EditEvent", "Organizer", new { id = evt.id })" style="background: #3b82f6; color: white; padding: 6px 12px; border-radius: 6px; text-decoration: none; font-size: 14px; font-weight: 500;">Edit</a>
                                <a href="@Url.Action("Details", "Event", new { id = evt.id })" target="_blank" style="background: #6b7280; color: white; padding: 6px 12px; border-radius: 6px; text-decoration: none; font-size: 14px; font-weight: 500;">View</a>
                                @using (Html.BeginForm("DeleteEvent", "Organizer", FormMethod.Post, new { style = "display: inline;", onsubmit = "return confirm('Are you sure you want to delete this event?');" }))
                                {
                                    @Html.AntiForgeryToken()
                                    @Html.Hidden("id", evt.id)
                                    <button type="submit" style="background: #ef4444; color: white; padding: 6px 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Delete</button>
                                }
                                <a href="@Url.Action("ManagePerformances", "Organizer", new { eventId = evt.id })" style="background: #10b981; color: white; padding: 6px 12px; border-radius: 6px; text-decoration: none; font-size: 14px; font-weight: 500;">Performances</a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div style="background: white; padding: 40px; border-radius: 12px; border: 1px solid #e5e7eb; text-align: center;">
        <p style="color: #666; margin: 0;">You have no events created yet.</p>
    </div>
}
